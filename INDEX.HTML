<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>My PDF Viewer</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    /* Your existing styles (keep same) ... */
    /* Additional style for warning message */
    #warning {
      margin: 20px auto;
      padding: 15px;
      max-width: 600px;
      background: #ffe3e3;
      border: 2px solid #ff0000;
      color: #900;
      font-weight: 600;
      text-align: center;
      border-radius: 10px;
      display: none;
    }
  </style>
</head>
<body>

<header>
  <div class="btn-group">
    <button id="loadBtn">Show PDF</button>
    <button id="downloadBtn" disabled>Download PDF</button>
    <button id="printBtn" disabled>Print PDF</button>
  </div>
  <div class="btn-group">
    <button id="themeBtn">Toggle Theme</button>
    <button id="fullscreenBtn">Fullscreen</button>
  </div>
</header>

<div id="warning">
  ⚠️ <strong>Important:</strong> For security reasons, PDFs may not load properly if you open this file directly from your computer.<br />
  Please run a <em>local server</em> or upload your files to a web server.<br />
  <small>Try opening this folder with a simple server, for example, with Python:</small><br />
  <code>python -m http.server</code><br />
  Then open <code>http://localhost:8000</code> in your browser.
</div>

<main>
  <div id="pdf-wrapper">
    <div id="pdf-loader">Loading PDF...</div>
    <iframe id="pdf-frame" src="" allowfullscreen></iframe>
  </div>
</main>

<footer>
  <button id="prevPageBtn" disabled>Prev Page</button>
  <div id="page-info">Page 1</div>
  <button id="nextPageBtn" disabled>Next Page</button>
</footer>

<script>
  const pdfFrame = document.getElementById('pdf-frame');
  const pdfLoader = document.getElementById('pdf-loader');
  const loadBtn = document.getElementById('loadBtn');
  const downloadBtn = document.getElementById('downloadBtn');
  const printBtn = document.getElementById('printBtn');
  const themeBtn = document.getElementById('themeBtn');
  const fullscreenBtn = document.getElementById('fullscreenBtn');
  const prevPageBtn = document.getElementById('prevPageBtn');
  const nextPageBtn = document.getElementById('nextPageBtn');
  const pageInfo = document.getElementById('page-info');
  const warning = document.getElementById('warning');

  let currentPage = 1;
  const totalPages = 100; // Adjust if you know total pages
  let pdfLoaded = false;

  function showLoader(show) {
    pdfLoader.style.display = show ? 'flex' : 'none';
    pdfFrame.style.display = show ? 'none' : 'block';
  }

  function checkLocalFileProtocol() {
    return window.location.protocol === 'file:';
  }

  function loadPDF(page = 1) {
    if (checkLocalFileProtocol()) {
      // Show warning if running locally without server
      warning.style.display = 'block';
      alert('PDF loading may not work locally without a server. Please run a local server.');
      return;
    } else {
      warning.style.display = 'none';
    }
    showLoader(true);
    currentPage = page;
    pdfFrame.src = `myfile.pdf#page=${currentPage}`;
  }

  pdfFrame.addEventListener('load', () => {
    showLoader(false);
    pdfLoaded = true;
    updatePageInfo();
    enableControls(true);
  });

  function updatePageInfo() {
    pageInfo.textContent = `Page ${currentPage}`;
  }

  function enableControls(enabled) {
    downloadBtn.disabled = !enabled;
    printBtn.disabled = !enabled;
    prevPageBtn.disabled = !enabled || currentPage <= 1;
    nextPageBtn.disabled = !enabled || currentPage >= totalPages;
  }

  loadBtn.addEventListener('click', () => loadPDF(currentPage));

  downloadBtn.addEventListener('click', () => {
    window.open('myfile.pdf', '_blank');
  });

  printBtn.addEventListener('click', () => {
    if (pdfLoaded) pdfFrame.contentWindow.print();
  });

  themeBtn.addEventListener('click', () => {
    document.documentElement.dataset.theme =
      document.documentElement.dataset.theme === 'dark' ? 'light' : 'dark';
  });

  fullscreenBtn.addEventListener('click', () => {
    if (!document.fullscreenElement) {
      document.documentElement.requestFullscreen();
    } else {
      document.exitFullscreen();
    }
  });

  prevPageBtn.addEventListener('click', () => {
    if (currentPage > 1) {
      currentPage--;
      loadPDF(currentPage);
    }
  });

  nextPageBtn.addEventListener('click', () => {
    if (currentPage < totalPages) {
      currentPage++;
      loadPDF(currentPage);
    }
  });

  // On load, check if running locally and show warning
  if (checkLocalFileProtocol()) {
    warning.style.display = 'block';
  }
</script>

</body>
</html>
